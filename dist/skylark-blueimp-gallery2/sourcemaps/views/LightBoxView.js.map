{"version":3,"sources":["views/LightBoxView.js"],"names":["define","langx","$","Gallery","SliderView","LightBoxView","inherit","klassName","options","hidePageScrollbars","indicatorContainer","activeIndicatorClass","thumbnailProperty","thumbnailIndicators","initOptions","mixin","prototype","this","overrided","createIndicator","obj","thumbnailUrl","thumbnail","gallery","indicator","indicatorPrototype","cloneNode","title","getItemTitle","getItemProperty","undefined","getElementsByTagName","find","src","style","backgroundImage","addIndicator","index","length","list","setAttribute","appendChild","indicators","push","setActiveIndicator","activeIndicator","removeClass","addClass","initSlides","reload","container","document","createElement","children","addSlide","resetSlides","empty","handleClick","event","target","srcElement","parent","parentNode","preventDefault","slide","getNodeIndex","handleSlide","handleClose","installAddon","name","ctor","templates","default"],"mappings":";;;;;;;AAAAA,QACC,sBACA,qBACA,aACA,gBACE,SAAUC,EAAMC,EAAGC,EAASC,GAE9B,IAAIC,EAAeD,EAAWE,SAC7BC,UAAW,eACXC,SAECC,oBAAoB,EAGpBC,mBAAoB,KAEpBC,qBAAsB,SAGtBC,kBAAmB,YAEnBC,qBAAqB,GAItBC,YAAa,SAAUN,GAClBA,EAAUP,EAAMc,SAAUV,EAAaW,UAAUR,QAASA,GAC9DS,KAAKC,UAAUV,IAGhBW,gBAAiB,SAAUC,GAC1B,IAIIC,EACAC,EALAC,EAAUN,KAAKM,QAClBC,EAAYP,KAAKQ,mBAAmBC,WAAU,GAC3CC,EAAQJ,EAAQK,aAAaR,GAC7BR,EAAoBK,KAAKT,QAAQI,kBAoBrC,OAjBIK,KAAKT,QAAQK,sBACZD,IACHS,EAAelB,EAAQ0B,gBAAgBT,EAAKR,SAExBkB,IAAjBT,IACHC,EAAYF,EAAIW,sBAAwB7B,EAAEkB,GAAKY,KAAK,OAAO,MAE1DX,EAAeC,EAAUW,KAGvBZ,IACHG,EAAUU,MAAMC,gBAAkB,QAAUd,EAAe,OAGzDM,IACHH,EAAUG,MAAQA,GAEZH,GAGRY,aAAc,SAAUC,GACvB,GAAIpB,KAAKP,mBAAmB4B,OAAQ,CACnC,IAAId,EAAYP,KAAKE,gBAAgBF,KAAKsB,KAAKF,IAC/Cb,EAAUgB,aAAa,aAAcH,GACrCpB,KAAKP,mBAAmB,GAAG+B,YAAYjB,GACvCP,KAAKyB,WAAWC,KAAKnB,KAIvBoB,mBAAoB,SAAUP,GACzBpB,KAAKyB,aACJzB,KAAK4B,iBACR5B,KAAK4B,gBAAgBC,YAAY7B,KAAKT,QAAQG,sBAE/CM,KAAK4B,gBAAkB3C,EAAEe,KAAKyB,WAAWL,IACzCpB,KAAK4B,gBAAgBE,SAAS9B,KAAKT,QAAQG,wBAI7CqC,WAAY,SAAUC,GAChBA,IACJhC,KAAKP,mBAAqBO,KAAKiC,UAAUlB,KACxCf,KAAKT,QAAQE,oBAEVO,KAAKP,mBAAmB4B,SAC3BrB,KAAKQ,mBAAqB0B,SAASC,cAAc,MACjDnC,KAAKyB,WAAazB,KAAKP,mBAAmB,GAAG2C,WAG/CpC,KAAKC,UAAU+B,IAGhBK,SAAU,SAAUjB,GACnBpB,KAAKC,UAAUmB,GACfpB,KAAKmB,aAAaC,IAGnBkB,YAAa,WACZtC,KAAKC,YACLD,KAAKP,mBAAmB8C,QACxBvC,KAAKyB,eAGNe,YAAa,SAAUC,GACtB,IAAIC,EAASD,EAAMC,QAAUD,EAAME,WAC/BC,EAASF,EAAOG,WACpB,GAAID,IAAW5C,KAAKP,mBAAmB,GAEtCO,KAAK8C,eAAeL,GACpBzC,KAAK+C,MAAM/C,KAAKgD,aAAaN,QACvB,CAAA,GAAIE,EAAOC,aAAe7C,KAAKP,mBAAmB,GAKxD,OAAOO,KAAKC,UAAUwC,GAHtBzC,KAAK8C,eAAeL,GACpBzC,KAAK+C,MAAM/C,KAAKgD,aAAaJ,MAM/BK,YAAa,SAAU7B,GACtBpB,KAAKC,UAAUmB,GACfpB,KAAK2B,mBAAmBP,IAGzB8B,YAAa,WACRlD,KAAK4B,iBACR5B,KAAK4B,gBAAgBC,YAAY7B,KAAKT,QAAQG,sBAE/CM,KAAKC,eAkBP,OAbAf,EAAQiE,aAAa,SACpBC,KAAQ,WACRC,KAAQjE,EACRkE,WACCC,QAAW,kJASNnE","file":"../../views/LightBoxView.js","sourcesContent":["define([\r\n\t'skylark-langx/langx',\r\n\t\"skylark-domx-query\",\r\n\t'../Gallery',\r\n\t'./SliderView'\r\n], function (langx,$, Gallery, SliderView) {\r\n\r\n\tvar LightBoxView = SliderView.inherit({\r\n\t\tklassName: \"LightBoxView\",\r\n\t\toptions: {\r\n\t\t\t// Hide the page scrollbars:\r\n\t\t\thidePageScrollbars: false,\r\n\r\n\t\t\t// The tag name, Id, element or querySelector of the indicator container:\r\n\t\t\tindicatorContainer: 'ol',\r\n\t\t\t// The class for the active indicator:\r\n\t\t\tactiveIndicatorClass: 'active',\r\n\t\t\t// The list object property (or data attribute) with the thumbnail URL,\r\n\t\t\t// used as alternative to a thumbnail child element:\r\n\t\t\tthumbnailProperty: 'thumbnail',\r\n\t\t\t// Defines if the gallery indicators should display a thumbnail:\r\n\t\t\tthumbnailIndicators: true\r\n\t\t},\r\n\r\n\r\n\t\tinitOptions: function (options) {\r\n\t\t\tvar options = langx.mixin({}, LightBoxView.prototype.options, options);\r\n\t\t\tthis.overrided(options);\r\n\t\t},\r\n\r\n\t\tcreateIndicator: function (obj) {\r\n\t\t\tvar gallery = this.gallery,\r\n\t\t\t\tindicator = this.indicatorPrototype.cloneNode(false)\r\n\t\t\tvar title = gallery.getItemTitle(obj)\r\n\t\t\tvar thumbnailProperty = this.options.thumbnailProperty\r\n\t\t\tvar thumbnailUrl\r\n\t\t\tvar thumbnail\r\n\t\t\tif (this.options.thumbnailIndicators) {\r\n\t\t\t\tif (thumbnailProperty) {\r\n\t\t\t\t\tthumbnailUrl = Gallery.getItemProperty(obj, thumbnailProperty)\r\n\t\t\t\t}\r\n\t\t\t\tif (thumbnailUrl === undefined) {\r\n\t\t\t\t\tthumbnail = obj.getElementsByTagName && $(obj).find('img')[0]\r\n\t\t\t\t\tif (thumbnail) {\r\n\t\t\t\t\t\tthumbnailUrl = thumbnail.src\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (thumbnailUrl) {\r\n\t\t\t\t\tindicator.style.backgroundImage = 'url(\"' + thumbnailUrl + '\")'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (title) {\r\n\t\t\t\tindicator.title = title;\r\n\t\t\t}\r\n\t\t\treturn indicator;\r\n\t\t},\r\n\r\n\t\taddIndicator: function (index) {\r\n\t\t\tif (this.indicatorContainer.length) {\r\n\t\t\t\tvar indicator = this.createIndicator(this.list[index])\r\n\t\t\t\tindicator.setAttribute('data-index', index)\r\n\t\t\t\tthis.indicatorContainer[0].appendChild(indicator)\r\n\t\t\t\tthis.indicators.push(indicator)\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetActiveIndicator: function (index) {\r\n\t\t\tif (this.indicators) {\r\n\t\t\t\tif (this.activeIndicator) {\r\n\t\t\t\t\tthis.activeIndicator.removeClass(this.options.activeIndicatorClass)\r\n\t\t\t\t}\r\n\t\t\t\tthis.activeIndicator = $(this.indicators[index])\r\n\t\t\t\tthis.activeIndicator.addClass(this.options.activeIndicatorClass)\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tinitSlides: function (reload) {\r\n\t\t\tif (!reload) {\r\n\t\t\t\tthis.indicatorContainer = this.container.find(\r\n\t\t\t\t\tthis.options.indicatorContainer\r\n\t\t\t\t)\r\n\t\t\t\tif (this.indicatorContainer.length) {\r\n\t\t\t\t\tthis.indicatorPrototype = document.createElement('li')\r\n\t\t\t\t\tthis.indicators = this.indicatorContainer[0].children\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.overrided(reload);\r\n\t\t},\r\n\r\n\t\taddSlide: function (index) {\r\n\t\t\tthis.overrided(index);\r\n\t\t\tthis.addIndicator(index)\r\n\t\t},\r\n\r\n\t\tresetSlides: function () {\r\n\t\t\tthis.overrided();\r\n\t\t\tthis.indicatorContainer.empty();\r\n\t\t\tthis.indicators = [];\r\n\t\t},\r\n\r\n\t\thandleClick: function (event) {\r\n\t\t\tvar target = event.target || event.srcElement\r\n\t\t\tvar parent = target.parentNode\r\n\t\t\tif (parent === this.indicatorContainer[0]) {\r\n\t\t\t\t// Click on indicator element\r\n\t\t\t\tthis.preventDefault(event)\r\n\t\t\t\tthis.slide(this.getNodeIndex(target))\r\n\t\t\t} else if (parent.parentNode === this.indicatorContainer[0]) {\r\n\t\t\t\t// Click on indicator child element\r\n\t\t\t\tthis.preventDefault(event)\r\n\t\t\t\tthis.slide(this.getNodeIndex(parent))\r\n\t\t\t} else {\r\n\t\t\t\treturn this.overrided(event)\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\thandleSlide: function (index) {\r\n\t\t\tthis.overrided(index)\r\n\t\t\tthis.setActiveIndicator(index)\r\n\t\t},\r\n\r\n\t\thandleClose: function () {\r\n\t\t\tif (this.activeIndicator) {\r\n\t\t\t\tthis.activeIndicator.removeClass(this.options.activeIndicatorClass)\r\n\t\t\t}\r\n\t\t\tthis.overrided();\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tGallery.installAddon(\"views\", {\r\n\t\t\"name\": \"lightbox\",\r\n\t\t\"ctor\": LightBoxView,\r\n\t\t\"templates\": {\r\n\t\t\t\"default\": '<div class=\"slides\"></div>' +\r\n\t\t\t\t'<h3 class=\"title\"></h3>' +\r\n\t\t\t\t'<a class=\"prev\">‹</a>' +\r\n\t\t\t\t'<a class=\"next\">›</a>' +\r\n\t\t\t\t'<a class=\"close\">×</a>' +\r\n\t\t\t\t'<ol class=\"indicator\"></ol>'\r\n\t\t}\r\n\t});\r\n\r\n\treturn LightBoxView;\r\n\r\n});"]}